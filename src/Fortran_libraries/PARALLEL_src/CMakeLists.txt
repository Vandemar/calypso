# Get sources from each subdirectory
FILE(GLOB COMM_SRC_FILES COMM_src/*.[fF]90)
FILE(GLOB SPH_SHELL_SRC_FILES SPH_SHELL_src/*.[fF]90)
FILE(GLOB 
SET(CALYPSO_PARALLEL_SRC_FILES ${COMM_SRC_FILES} ${SPH_SHELL_SRC_FILES})

#CUDA
IF (CUDA_FOUND)
  IF (CMAKE_Fortran_COMPILER MATCHES "gfortran.*")
    IF (CMAKE_C_COMPILER MATCHES "gcc.*")
      #geared towards Maverick
      SET (CMAKE_CUDA_C_FLAGS "-c${CUDA_TOOLKIT_ROOT_DIR}/src/fortran_thunking.c -I${CUDA_TOOLKIT_ROOT_DIR}/include -L${CUDA_TOOLKIT_ROOT_DIR}/lib64 -DCUBLAS_USE_THUNKING -DCUBLAS_GFORTRAN -lcudart -lcublas")
    ENDIF(CMAKE_C_COMPILER MATCHES "gcc.*")
    SET (CMAKE_Fortran_FLAGS " -O3 -DCUBLAS smvMultiply.f90 iFortran.o -L$TACC_CUDA_LIB -lcublas -lcudart")
  ENDIF(CMAKE_Fortran_COMPILER MATCHES "gfortran.*")
ENDIF (CUDA_FOUND)

